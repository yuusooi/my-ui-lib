<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <style>
        #container {
            width: 300px;
            height: 20px;
            background-color: #eee;
            border-radius: 10px;
            overflow: hidden;
        }

        #bar {
            width: 0;
            /* 初始宽度为 0 */
            height: 100%;
            background-color: #4caf50;
        }
    </style>
</head>

<body>

    <div id="container">
        <div id="bar"></div>
    </div>
    <button onclick="startAnimation()">开始加载</button>

    <script>
        const bar = document.getElementById('bar');
        let progress = 0;
        let animationId = null; // 用于停止动画

        function step() {
            // 1. 更新状态
            progress += 1; // 每次增加 1%

            // 2. 更新 DOM
            bar.style.width = progress + '%';

            // 3. 判断是否继续
            if (progress < 100) {
                // ★★★ 核心：递归调用自身
                // 告诉浏览器：下一帧还得找我！
                animationId = requestAnimationFrame(step);
            } else {
                console.log('加载完成！');
                // 可以在这里 cancelAnimationFrame(animationId) 虽然不必要，但好习惯
            }
        }

        function startAnimation() {
            // 防止重复点击导致加速
            if (progress > 0 && progress < 100) return;

            progress = 0;
            // ★★★ 启动引擎
            animationId = requestAnimationFrame(step);
        }
    </script>
</body>

</html>